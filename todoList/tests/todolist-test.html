<!DOCTYPE html>
<html lang="en">
  <head>
    <link rel="stylesheet" href="../../../dijit/themes/claro/claro.css" />
    <meta charset="utf-8">
    <title>TodoList component test</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="SK">

  </head>

<body class="claro">
    <h2>All todos</h2>
	<div id="all-todos"></div>
    <h2>Active todos</h2>
    <div id="active-todos"></div>

    <script data-dojo-config="async: false"
        src="../../../dojo/dojo.js">
    </script>

    <script>
		require([
			'dojo/Stateful',
            'dojo/store/Memory',
            'dojo/store/Observable',
			'sktodos/todoList/TodoList',
            'sktodos/model/domain/Todo',
		], function(Stateful, Memory, Observable, TodoList, Todo){

            var t1 = window.t1 = new Todo({id: "1", label: "Faire les courses", checked: true, urgent: true});
            var t2 = window.t2 = new Todo({id: "2", label: "Faire le m√©nage", checked: false, urgent: false, dueDate: new Date(2012, 11, 25)});
            var t3 = window.t3 = new Todo({id: "3", label: "Faire la lessive", checked: false, urgent: true});

			window.externalModel = Observable(new Memory({
                data: [t1, t2, t3],
            }));;


			var allTodos = window.allTodos = new TodoList({
                todos: externalModel.query(),
			}, "all-todos");
			allTodos.startup();

            var activeTodos = window.activeTodos = new TodoList({
                todos: externalModel.query({checked: false}),
            }, "active-todos");
            activeTodos.startup();
            
            externalModel.data.forEach(function(todo){
                todo.watch("checked", function(){
                    externalModel.put(todo);
                });
            });


		});
	</script>
</body>
</html>